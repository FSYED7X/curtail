var Curtail=function(a){a=void 0===a?{}:a;this._options=Object.assign({autoDownload:!1,crossOrigin:null},a);this.FORMAT={PNG:{ext:"png",transparent:!0},JPG:{ext:"jpg",transparent:!1},GIF:{ext:"gif",transparent:!1},BMP:{ext:"bmp",transparent:!1},WEBP:{ext:"webp",transparent:!0},PDF:{ext:"pdf",transparent:!0}}};
Curtail.prototype.crop=function(a,f,h,g,c){var d=this,b=document.createElement("canvas"),m=b.getContext("2d"),e=a.lastIndexOf("/")+1||0,l=a.lastIndexOf("."),p=a.slice(e,l),n=a.slice(l+1),k=new Image;return new Promise(function(l,e){k.onload=function(){b.width=g;b.height=c;m.drawImage(k,f,h,g,c,0,0,g,c);var a=new Image;a.onload=function(){if(d._options.autoDownload){var b=document.createElement("a");b.href=a.src;b.download=p+"."+n;b.click()}l(a)};a.onerror=function(a){return e(a)};a.src=b.toDataURL("image/"+
n).replace("image/"+n,"image/octet-stream")};k.onerror=function(a){return e(a)};k.src=a;d._options.crossOrigin&&(k.crossOrigin=d._options.crossOrigin)})};
Curtail.prototype.convert=function(a,f){var h=this,g=extract.getFileInfo(a);if(g.ext===f.ext)console.warn("Image is already in desired format.");else{var c=document.createElement("canvas"),d=c.getContext("2d"),b=new Image;return new Promise(function(m,e){b.onload=function(){c.width=b.width;c.height=b.height;f.transparent||(d.fillStyle="#FFF",d.fillRect(0,0,c.width,c.height));d.drawImage(b,0,0);var a=new Image;a.onload=function(){if(h._options.autoDownload){var b=document.createElement("a");b.href=
a.src;b.download=g.name+"."+f.ext;b.click()}m(a)};a.onerror=function(a){return e(a)};a.src=c.toDataURL("image/"+f.ext)};b.onerror=function(a){return e(a)};b.src=a;h._options.crossOrigin&&(b.crossOrigin=h._options.crossOrigin)})}};